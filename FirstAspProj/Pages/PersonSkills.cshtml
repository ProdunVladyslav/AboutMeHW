@page "person-skills/{id:int}"
@model PersonSkillsModel
@{
    ViewData["Title"] = "Skills";
    var afterDeleteMessage = ViewData["AfterDeleteMessage"];
}

<h2 class="mt-4 mb-3">
    Skills for @Model.Person.FirstName @Model.Person.LastName
</h2>

<div class="card shadow-sm">
    <div class="card-body p-0">
        <table class="table table-hover mb-0 align-middle">
            <thead class="table-light">
                <tr>
                    <th style="width:80px;">ID</th>
                    <th>Title</th>
                    <th style="width:150px;">Proficiency</th>
                    <th class="text-end" style="width:220px;">Actions</th>
                </tr>
            </thead>

            <tbody>
                @if (Model.Skills.Any())
                {
                    foreach (var skill in Model.Skills)
                    {
                        <tr>
                            <td>@skill.Id</td>
                            <td>@skill.Title</td>
                            <td>@skill.Proficiency</td>

                            <td class="text-end">
                                <a asp-page="/EditSkill"
                                   asp-route-id="@skill.Id"
                                   asp-route-personId="@Model.Person.Id"
                                   class="btn btn-sm btn-primary me-2">
                                    Edit
                                </a>

                                <form method="post"
                                      asp-page-handler="Delete"
                                      asp-route-skillId="@skill.Id"
                                      asp-route-personId="@Model.Person.Id"
                                      class="d-inline">
                                    <button type="submit"
                                            class="btn btn-sm btn-outline-danger"
                                            onclick="return confirm('Delete skill @skill.Title?');">
                                        Delete
                                    </button>
                                </form>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="4" class="text-center py-4 text-muted">
                            No skills assigned.
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="mt-3 d-flex justify-content-end">
    <a asp-page="/AddSkill"
       asp-route-personId="@Model.Person.Id"
       class="btn btn-success">
        Add Skill
    </a>
</div>

<style>
    body {
        background: #f8fafc;
    }

    .card {
        border-radius: 12px;
        overflow: hidden;
    }

    .table thead th {
        font-weight: 600;
    }

    .btn {
        border-radius: 8px;
    }
</style>

@section HeadScripts {

}

@section Scripts {
    <script src="~/js/confirm-delete.js" asp-append-version="true"></script>

    <script>
            function showAfterDeleteMessage() {
                Swal.fire({
                    position: "top-end",
                    icon: "success",
                    title: "@afterDeleteMessage",
                    showConfirmButton: false,
                    timer: 1500
                });
             }

        @(afterDeleteMessage != null ? "showAfterDeleteMessage();" : "")
    </script>
}
